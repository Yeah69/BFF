<ResourceDictionary x:Class="BFF.View.Wpf.Resources.TransCellTemplates"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
                    xmlns:forModels="clr-namespace:BFF.ViewModel.ViewModels.ForModels;assembly=BFF.ViewModel"
                    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                    xmlns:structure="clr-namespace:BFF.ViewModel.ViewModels.ForModels.Structure;assembly=BFF.ViewModel"
                    xmlns:utility="clr-namespace:BFF.ViewModel.ViewModels.ForModels.Utility;assembly=BFF.ViewModel"
                    xmlns:helper="clr-namespace:BFF.View.Wpf.Helper"
                    xmlns:attachedBehaviors="clr-namespace:BFF.View.Wpf.AttachedBehaviors"
                    xmlns:views="clr-namespace:BFF.View.Wpf.Views">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/BFF.View.Wpf;component/Resources/BFF_ModifiedMAMCheckBox.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style x:Key="CellContent"
           TargetType="ContentControl">
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="MinHeight" Value="30" />
        <Setter Property="IsTabStop" Value="False" />
    </Style>

    <DataTemplate x:Key="ParentTransactionToolTipTemplate"
                  DataType="{x:Type forModels:ParentTransactionViewModel}">
        <StackPanel>
            <TextBlock Margin="2.5"
                       Text="{Binding CurrentTexts.ToolTip_Symbol_SplitTransaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
            <DataGrid Margin="2.5"
                      ItemsSource="{Binding SubTransactions}">
                <DataGrid.Columns>
                    <!--  Category  -->
                    <DataGridTextColumn Binding="{Binding Category.Name}"
                                        Header="{Binding CurrentTexts.AccountView_Header_Category, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    <!--  Memo  -->
                    <DataGridTextColumn Binding="{Binding Memo}"
                                        Header="{Binding CurrentTexts.AccountView_Header_Memo, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    <!--  Sum  -->
                    <DataGridTemplateColumn Header="{Binding CurrentTexts.AccountView_Header_Sum, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Foreground="{Binding Sum.Value, Converter={x:Static helper:Converters.SumToSolidColorBrush}}"
                                           Text="{Binding Sum.Value, Converter={x:Static helper:Converters.SumToString}}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
    </DataTemplate>

    <!--  Symbol  -->
    <DataTemplate x:Key="SymbolColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type forModels:TransactionViewModel}">
                    <Grid Background="Transparent">
                        <b:Interaction.Behaviors>
                            <attachedBehaviors:FrameworkElementClickBehavior Click="SymbolNewIcon_OnClick" />
                        </b:Interaction.Behaviors>
                        <Popup x:Name="ConvertMenu"
                               PlacementTarget="{Binding ElementName=Icon}"
                               StaysOpen="False">
                            <Border Style="{StaticResource PopupBorder}">
                                <Button Margin="2.5"
                                        Command="{Binding InsertedConvertToParentTransaction}">
                                    <Button.Content>
                                        <StackPanel Orientation="Horizontal">
                                            <iconPacks:PackIconMaterial>
                                                <iconPacks:PackIconMaterial.Style>
                                                    <Style BasedOn="{StaticResource CellIconMaterial}"
                                                           TargetType="{x:Type iconPacks:PackIconMaterial}">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Category, Converter={x:Static helper:Converters.OfType}, ConverterParameter={x:Type forModels:IIncomeCategoryViewModel}}"
                                                                         Value="True">
                                                                <Setter Property="Kind" Value="{StaticResource IncomeIcon}" />
                                                                <Setter Property="Foreground" Value="{DynamicResource IncomeBrush}" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                        <Setter Property="Kind" Value="{StaticResource TransactionIcon}" />
                                                        <Setter Property="Foreground" Value="{DynamicResource TransactionBrush}" />
                                                    </Style>
                                                </iconPacks:PackIconMaterial.Style>
                                            </iconPacks:PackIconMaterial>
                                            <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                        Height="{StaticResource IconSize}"
                                                                        Margin="5,0,0,0"
                                                                        Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                        Kind="ChevronDoubleRight" />
                                            <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                        Height="{StaticResource IconSize}"
                                                                        Margin="5,0,0,0"
                                                                        Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                        Kind="{StaticResource ParentIcon}" />
                                            <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                        Height="{StaticResource IconSize}"
                                                                        Margin="5,0,0,0"
                                                                        Foreground="{DynamicResource TransactionBrush}"
                                                                        Kind="{StaticResource TransactionIcon}" />
                                        </StackPanel>
                                    </Button.Content>
                                </Button>
                            </Border>
                        </Popup>
                        <iconPacks:PackIconMaterial x:Name="Icon"
                                                    Background="Transparent">
                            <iconPacks:PackIconMaterial.Style>
                                <Style BasedOn="{StaticResource CellIconMaterial}"
                                       TargetType="{x:Type iconPacks:PackIconMaterial}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Category, Converter={x:Static helper:Converters.OfType}, ConverterParameter={x:Type forModels:IIncomeCategoryViewModel}}"
                                                     Value="True">
                                            <Setter Property="Kind" Value="{StaticResource IncomeIcon}" />
                                            <Setter Property="ToolTip" Value="{Binding CurrentTexts.ToolTip_Symbol_IncomeTransaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                            <Setter Property="Foreground" Value="{DynamicResource IncomeBrush}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                    <Setter Property="Kind" Value="{StaticResource TransactionIcon}" />
                                    <Setter Property="ToolTip" Value="{Binding CurrentTexts.ToolTip_Symbol_Transaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                    <Setter Property="Foreground" Value="{DynamicResource TransactionBrush}" />
                                </Style>
                            </iconPacks:PackIconMaterial.Style>
                        </iconPacks:PackIconMaterial>
                    </Grid>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:ParentTransactionViewModel}">
                    <Grid Background="Transparent">
                        <b:Interaction.Behaviors>
                            <attachedBehaviors:FrameworkElementClickBehavior Click="SymbolNewIcon_OnClick" />
                        </b:Interaction.Behaviors>
                        <Popup x:Name="ConvertMenu"
                               PlacementTarget="{Binding ElementName=Icon}"
                               StaysOpen="False">
                            <Border Style="{StaticResource PopupBorder}">

                                <Button Margin="2.5"
                                        Command="{Binding InsertedConvertToTransaction}">
                                    <Button.Content>
                                        <StackPanel Orientation="Horizontal">
                                            <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                        Height="{StaticResource IconSize}"
                                                                        Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                        Kind="{StaticResource ParentIcon}" />
                                            <iconPacks:PackIconMaterial Margin="5,0,0,0"
                                                                        Foreground="{DynamicResource TransactionBrush}"
                                                                        Kind="{StaticResource TransactionIcon}"
                                                                        Style="{StaticResource CellIconMaterial}" />
                                            <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                        Height="{StaticResource IconSize}"
                                                                        Margin="5,0,0,0"
                                                                        Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                        Kind="ChevronDoubleRight" />
                                            <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                        Height="{StaticResource IconSize}"
                                                                        Margin="5,0,0,0"
                                                                        Foreground="{DynamicResource TransactionBrush}"
                                                                        Kind="{StaticResource TransactionIcon}" />
                                        </StackPanel>
                                    </Button.Content>
                                </Button>
                            </Border>
                        </Popup>
                        <iconPacks:PackIconMaterial x:Name="Icon"
                                                    Background="Transparent"
                                                    Foreground="{DynamicResource TransactionBrush}"
                                                    Kind="{StaticResource TransactionIcon}"
                                                    Style="{StaticResource CellIconMaterial}"
                                                    ToolTip="{Binding CurrentTexts.ToolTip_Symbol_Transaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    </Grid>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <iconPacks:PackIconMaterial Background="Transparent"
                                                Foreground="{DynamicResource TransferBrush}"
                                                Kind="{StaticResource TransferIcon}"
                                                Style="{StaticResource CellIconMaterial}"
                                                ToolTip="{Binding CurrentTexts.ToolTip_Symbol_Transfer, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="SymbolNewColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type forModels:TransactionViewModel}">
                    <Grid Background="Transparent">
                        <b:Interaction.Behaviors>
                            <attachedBehaviors:FrameworkElementClickBehavior Click="SymbolNewIcon_OnClick" />
                        </b:Interaction.Behaviors>
                        <Popup x:Name="ConvertMenu"
                               PlacementTarget="{Binding ElementName=Icon}"
                               StaysOpen="False">
                            <Border Style="{StaticResource PopupBorder}">
                                <StackPanel Orientation="Horizontal">
                                    <Button Margin="2.5"
                                            Command="{Binding NonInsertedConvertToParentTransaction}">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal">
                                                <iconPacks:PackIconMaterial>
                                                    <iconPacks:PackIconMaterial.Style>
                                                        <Style BasedOn="{StaticResource CellIconMaterial}"
                                                               TargetType="{x:Type iconPacks:PackIconMaterial}">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Category, Converter={x:Static helper:Converters.OfType}, ConverterParameter={x:Type forModels:IIncomeCategoryViewModel}}"
                                                                             Value="True">
                                                                    <Setter Property="Kind" Value="{StaticResource IncomeIcon}" />
                                                                    <Setter Property="Foreground" Value="{DynamicResource IncomeBrush}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                            <Setter Property="Kind" Value="{StaticResource TransactionIcon}" />
                                                            <Setter Property="Foreground" Value="{DynamicResource TransactionBrush}" />
                                                        </Style>
                                                    </iconPacks:PackIconMaterial.Style>
                                                </iconPacks:PackIconMaterial>
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="ChevronDoubleRight" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="{StaticResource ParentIcon}" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransactionBrush}"
                                                                            Kind="{StaticResource TransactionIcon}" />
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                    <Button Margin="2.5"
                                            Command="{Binding NonInsertedConvertToTransfer}">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal">
                                                <iconPacks:PackIconMaterial>
                                                    <iconPacks:PackIconMaterial.Style>
                                                        <Style BasedOn="{StaticResource CellIconMaterial}"
                                                               TargetType="{x:Type iconPacks:PackIconMaterial}">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Category, Converter={x:Static helper:Converters.OfType}, ConverterParameter={x:Type forModels:IIncomeCategoryViewModel}}"
                                                                             Value="True">
                                                                    <Setter Property="Kind" Value="{StaticResource IncomeIcon}" />
                                                                    <Setter Property="Foreground" Value="{DynamicResource IncomeBrush}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                            <Setter Property="Kind" Value="{StaticResource TransactionIcon}" />
                                                            <Setter Property="Foreground" Value="{DynamicResource TransactionBrush}" />
                                                        </Style>
                                                    </iconPacks:PackIconMaterial.Style>
                                                </iconPacks:PackIconMaterial>
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="ChevronDoubleRight" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransferBrush}"
                                                                            Kind="{StaticResource TransferIcon}" />
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Border>
                        </Popup>
                        <iconPacks:PackIconMaterial x:Name="Icon"
                                                    Background="Transparent">
                            <iconPacks:PackIconMaterial.Style>
                                <Style BasedOn="{StaticResource CellIconMaterial}"
                                       TargetType="{x:Type iconPacks:PackIconMaterial}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Category, Converter={x:Static helper:Converters.OfType}, ConverterParameter={x:Type forModels:IIncomeCategoryViewModel}}"
                                                     Value="True">
                                            <Setter Property="Kind" Value="{StaticResource IncomeIcon}" />
                                            <Setter Property="ToolTip" Value="{Binding CurrentTexts.ToolTip_Symbol_IncomeTransaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                            <Setter Property="Foreground" Value="{DynamicResource IncomeBrush}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                    <Setter Property="Kind" Value="{StaticResource TransactionIcon}" />
                                    <Setter Property="ToolTip" Value="{Binding CurrentTexts.ToolTip_Symbol_Transaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                    <Setter Property="Foreground" Value="{DynamicResource TransactionBrush}" />
                                </Style>
                            </iconPacks:PackIconMaterial.Style>
                        </iconPacks:PackIconMaterial>
                    </Grid>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:ParentTransactionViewModel}">
                    <Grid Background="Transparent">
                        <b:Interaction.Behaviors>
                            <attachedBehaviors:FrameworkElementClickBehavior Click="SymbolNewIcon_OnClick" />
                        </b:Interaction.Behaviors>
                        <Popup x:Name="ConvertMenu"
                               PlacementTarget="{Binding ElementName=Icon}"
                               StaysOpen="False">
                            <Border Style="{StaticResource PopupBorder}">
                                <StackPanel Orientation="Horizontal">
                                    <Button Margin="2.5"
                                            Command="{Binding NonInsertedConvertToTransaction}">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal">
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="{StaticResource ParentIcon}" />
                                                <iconPacks:PackIconMaterial Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransactionBrush}"
                                                                            Kind="{StaticResource TransactionIcon}"
                                                                            Style="{StaticResource CellIconMaterial}" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="ChevronDoubleRight" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransactionBrush}"
                                                                            Kind="{StaticResource TransactionIcon}" />
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                    <Button Margin="2.5"
                                            Command="{Binding NonInsertedConvertToTransfer}">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal">
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="{StaticResource ParentIcon}" />
                                                <iconPacks:PackIconMaterial Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransactionBrush}"
                                                                            Kind="{StaticResource TransactionIcon}"
                                                                            Style="{StaticResource CellIconMaterial}" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="ChevronDoubleRight" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransferBrush}"
                                                                            Kind="{StaticResource TransferIcon}" />
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Border>
                        </Popup>
                        <iconPacks:PackIconMaterial x:Name="Icon"
                                                    Background="Transparent"
                                                    Foreground="{DynamicResource TransactionBrush}"
                                                    Kind="{StaticResource TransactionIcon}"
                                                    Style="{StaticResource CellIconMaterial}"
                                                    ToolTip="{Binding CurrentTexts.ToolTip_Symbol_Transaction, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    </Grid>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <Grid Background="Transparent">
                        <b:Interaction.Behaviors>
                            <attachedBehaviors:FrameworkElementClickBehavior Click="SymbolNewIcon_OnClick" />
                        </b:Interaction.Behaviors>
                        <Popup x:Name="ConvertMenu"
                               PlacementTarget="{Binding ElementName=Icon}"
                               StaysOpen="False">
                            <Border Style="{StaticResource PopupBorder}">
                                <StackPanel Orientation="Horizontal">
                                    <Button Margin="2.5"
                                            Command="{Binding NonInsertedConvertToTransaction}">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal">
                                                <iconPacks:PackIconMaterial Foreground="{DynamicResource TransferBrush}"
                                                                            Kind="{StaticResource TransferIcon}"
                                                                            Style="{StaticResource CellIconMaterial}" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="ChevronDoubleRight" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransactionBrush}"
                                                                            Kind="{StaticResource TransactionIcon}" />
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                    <Button Margin="2.5"
                                            Command="{Binding NonInsertedConvertToParentTransaction}">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal">
                                                <iconPacks:PackIconMaterial Foreground="{DynamicResource TransferBrush}"
                                                                            Kind="{StaticResource TransferIcon}"
                                                                            Style="{StaticResource CellIconMaterial}" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="ChevronDoubleRight" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                                            Kind="{StaticResource ParentIcon}" />
                                                <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                                            Height="{StaticResource IconSize}"
                                                                            Margin="5,0,0,0"
                                                                            Foreground="{DynamicResource TransactionBrush}"
                                                                            Kind="{StaticResource TransactionIcon}" />
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Border>
                        </Popup>
                        <iconPacks:PackIconMaterial x:Name="Icon"
                                                    Background="Transparent"
                                                    Foreground="{DynamicResource TransferBrush}"
                                                    Kind="{StaticResource TransferIcon}"
                                                    Style="{StaticResource CellIconMaterial}"
                                                    ToolTip="{Binding CurrentTexts.ToolTip_Symbol_Transfer, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    </Grid>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Account  -->
    <DataTemplate x:Key="AccountColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransactionBaseViewModel}">
                    <TextBlock Style="{StaticResource CellTextBlock}"
                               Text="{Binding Account.Name}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <TextBlock Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                               Style="{StaticResource CellTextBlock}"
                               Text="{Binding CurrentTexts.AccountView_Column_Transfer, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="AccountEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransactionBaseViewModel}">
                    <ComboBox DisplayMemberPath="Name"
                              IsEditable="True"
                              IsTextSearchCaseSensitive="False"
                              IsTextSearchEnabled="True"
                              ItemsSource="{Binding AllAccounts}"
                              TextSearch.TextPath="Name">
                        <ComboBox.SelectedItem>
                            <Binding Mode="TwoWay"
                                     Path="Account"
                                     UpdateSourceTrigger="LostFocus" />
                        </ComboBox.SelectedItem>
                    </ComboBox>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <TextBlock Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                               Style="{StaticResource CellTextBlock}"
                               Text="{Binding CurrentTexts.AccountView_Column_Transfer, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Date  -->
    <DataTemplate x:Key="DateColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <TextBlock Style="{StaticResource CellTextBlock}"
                               Text="{Binding Date, Converter={x:Static helper:Converters.DateTimeToString}}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasDate}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <TextBlock Margin="0,2.5"
                                                               Style="{StaticResource CellTextBlock}"
                                                               Text="{Binding Date, Converter={x:Static helper:Converters.DateTimeToString}}" />
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate" Value="{StaticResource EmptyDataTemplate}" />
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="DateEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <DatePicker VerticalContentAlignment="Center"
                                SelectedDate="{Binding Date, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedDateFormat="{Binding DataContext.IsDateLong, ElementName=LayoutRoot, Converter={x:Static helper:Converters.BooleanToDatePickerFormat}}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasDate}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <DockPanel LastChildFill="True">
                                                        <Button Margin="0,2.5"
                                                                Command="{Binding DismissDate}"
                                                                Content="X"
                                                                DockPanel.Dock="Right" />
                                                        <DatePicker Margin="0,2.5"
                                                                    VerticalContentAlignment="Center"
                                                                    DockPanel.Dock="Left"
                                                                    SelectedDate="{Binding Date, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                    SelectedDateFormat="{Binding ShowLongDate, Converter={x:Static helper:Converters.BooleanToDatePickerFormat}}" />
                                                    </DockPanel>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Button Margin="0,2.5"
                                                    HorizontalAlignment="Right"
                                                    Command="{Binding AdmitDate}"
                                                    Content="+" />
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Flag  -->
    <DataTemplate x:Key="FlagColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <ContentControl Content="{Binding Flag}"
                                    ContentTemplate="{StaticResource FlagTemplate}">
                        <ContentControl.Style>
                            <Style BasedOn="{StaticResource {x:Type ContentControl}}"
                                   TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <Trigger Property="Content" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="FlagEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <DockPanel LastChildFill="True">
                        <Button Click="OpenFlagPopup_OnClick"
                                DockPanel.Dock="Right"
                                TabIndex="1"
                                ToolTip="{Binding CurrentTexts.CreateNewFlag, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}">
                            <iconPacks:PackIconMaterial Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                        Kind="{StaticResource AddIcon}"
                                                        Style="{StaticResource CellIconMaterial}" />
                        </Button>
                        <Popup x:Name="Popup"
                               Closed="Popup_OnClosed"
                               Placement="Right"
                               PlacementTarget="{Binding ElementName=EditFlagComboBox}"
                               PopupAnimation="Slide"
                               PreviewKeyDown="Popup_OnPreviewKeyDown"
                               StaysOpen="False">
                            <views:NewFlagView DataContext="{Binding NewFlagViewModel}"
                                               OnAddClicked="ClosePopup_OnClick"
                                               Tag="{Binding ElementName=Popup}" />
                        </Popup>
                        <Button Command="{Binding RemoveFlag}"
                                Content="X"
                                DockPanel.Dock="Right"
                                TabIndex="1">
                            <Button.Style>
                                <Style BasedOn="{StaticResource BffGeneralButtonStyle}"
                                       TargetType="{x:Type Button}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Flag}"
                                                     Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <ComboBox x:Name="EditFlagComboBox"
                                  HorizontalAlignment="Stretch"
                                  DockPanel.Dock="Left"
                                  ItemsSource="{Binding AllFlags}"
                                  SelectedItem="{Binding Mode=TwoWay, Path=Flag, UpdateSourceTrigger=LostFocus}"
                                  TabIndex="0">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <iconPacks:PackIconMaterial Foreground="{Binding Color, Converter={x:Static helper:Converters.ColorToBrush}}"
                                                                    Kind="{StaticResource FlagIcon}"
                                                                    Style="{StaticResource CellIconMaterial}" />
                                        <TextBlock Margin="5,0,0,0"
                                                   Text="{Binding Name}" />
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </DockPanel>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  CheckNumber  -->
    <DataTemplate x:Key="CheckNumberColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <TextBlock Style="{StaticResource CellTextBlock}"
                               Text="{Binding CheckNumber}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="CheckNumberEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <TextBox VerticalAlignment="Stretch"
                             VerticalContentAlignment="Center"
                             Text="{Binding CheckNumber, UpdateSourceTrigger=LostFocus}"
                             TextWrapping="NoWrap" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Payee  -->
    <DataTemplate x:Key="PayeeColumnTemplate">
        <ContentControl HorizontalAlignment="Stretch"
                        Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransactionBaseViewModel}">
                    <ContentControl Content="{Binding Payee}">
                        <ContentControl.Style>
                            <Style BasedOn="{StaticResource CellContent}"
                                   TargetType="ContentControl">
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <TextBlock Style="{StaticResource CellTextBlock}"
                                                       Text="{Binding Name}" />
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=Content}"
                                                 Value="{x:Null}">
                                        <Setter Property="ContentControl.ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <TextBlock Foreground="{StaticResource TransferBrush}"
                                                               Opacity="0.75"
                                                               Style="{StaticResource CellTextBlock}">
                                                        <Run Text="(" />
                                                        <Run Text="{Binding CurrentTexts.General_Unassigned, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                                        <Run Text=")" />
                                                    </TextBlock>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Style="{StaticResource CellTextBlock}"
                                   Text="{Binding FromAccount.Name}" />
                        <iconPacks:PackIconMaterial Background="Transparent"
                                                    Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                                                    Kind="{StaticResource TransactionIcon}"
                                                    Style="{StaticResource CellIconMaterial}"
                                                    ToolTip="{Binding CurrentTexts.ToolTip_Symbol_FromAccount, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    </StackPanel>
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasPayee}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <DockPanel LastChildFill="True">
                                                        <views:AlertSymbol VerticalAlignment="Center"
                                                                           DockPanel.Dock="Right"
                                                                           Visibility="{Binding PayeeExists, Converter={x:Static helper:Converters.TrueToCollapsed}}" />
                                                        <TextBlock Margin="0,2.5"
                                                                   DockPanel.Dock="Left"
                                                                   Style="{StaticResource CellTextBlock}"
                                                                   Text="{Binding Payee, Mode=OneWay}" />
                                                    </DockPanel>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate" Value="{StaticResource EmptyDataTemplate}" />
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="PayeeEditingColumnTemplate">
        <ContentControl HorizontalAlignment="Stretch"
                        Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransactionBaseViewModel}">
                    <DockPanel LastChildFill="True">
                        <Button Click="OpenPayeePopup_OnClick"
                                DockPanel.Dock="Right"
                                TabIndex="1"
                                ToolTip="{Binding CurrentTexts.CreateNewPayee, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}">
                            <iconPacks:PackIconMaterial Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                        Kind="{StaticResource AddIcon}"
                                                        Style="{StaticResource CellIconMaterial}" />
                        </Button>
                        <Popup x:Name="Popup"
                               Closed="Popup_OnClosed"
                               Placement="Right"
                               PlacementTarget="{Binding ElementName=EditPayeeComboBox}"
                               PopupAnimation="Slide"
                               PreviewKeyDown="Popup_OnPreviewKeyDown"
                               StaysOpen="False">
                            <views:NewPayeeView DataContext="{Binding NewPayeeViewModel}"
                                                OnAddClicked="ClosePopup_OnClick"
                                                Tag="{Binding ElementName=Popup}" />
                        </Popup>
                        <ComboBox x:Name="EditPayeeComboBox"
                                  DisplayMemberPath="Name"
                                  IsEditable="True"
                                  IsTextSearchCaseSensitive="True"
                                  IsTextSearchEnabled="True"
                                  ItemsSource="{Binding NewPayeeViewModel.AllPayees}"
                                  ShouldPreserveUserEnteredPrefix="True"
                                  TabIndex="0"
                                  TextSearch.TextPath="Name">
                            <ComboBox.SelectedItem>
                                <Binding Mode="TwoWay"
                                         Path="Payee"
                                         UpdateSourceTrigger="PropertyChanged">
                                    <Binding.ValidationRules>
                                        <x:Static Member="helper:Rules.EmptyPayee" />
                                    </Binding.ValidationRules>
                                </Binding>
                            </ComboBox.SelectedItem>
                        </ComboBox>
                    </DockPanel>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <ComboBox DisplayMemberPath="Name"
                              IsEditable="True"
                              IsTextSearchCaseSensitive="False"
                              IsTextSearchEnabled="True"
                              ItemsSource="{Binding AllAccounts}"
                              TextSearch.TextPath="Name">
                        <ComboBox.SelectedItem>
                            <Binding Mode="TwoWay"
                                     Path="FromAccount"
                                     UpdateSourceTrigger="LostFocus" />
                        </ComboBox.SelectedItem>
                    </ComboBox>
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasPayee}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <DockPanel LastChildFill="True">
                                                        <Button Margin="0,2.5"
                                                                Command="{Binding DismissPayee}"
                                                                Content="X"
                                                                DockPanel.Dock="Right" />
                                                        <views:AlertSymbol VerticalAlignment="Center"
                                                                           DockPanel.Dock="Right"
                                                                           Visibility="{Binding PayeeExists, Converter={x:Static helper:Converters.TrueToCollapsed}}" />
                                                        <ComboBox DisplayMemberPath="Name"
                                                                  DockPanel.Dock="Right"
                                                                  IsEditable="True"
                                                                  IsTextSearchCaseSensitive="True"
                                                                  IsTextSearchEnabled="True"
                                                                  ItemsSource="{Binding ExistingPayees}"
                                                                  Text="{Binding Payee}" />
                                                    </DockPanel>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Button Margin="0,2.5"
                                                    HorizontalAlignment="Right"
                                                    Command="{Binding AdmitPayee}"
                                                    Content="+" />
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Category  -->
    <DataTemplate x:Key="CategoryColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type forModels:ParentTransactionViewModel}">
                    <Button Margin="0"
                            Padding="0"
                            HorizontalContentAlignment="Left"
                            Background="Transparent"
                            BorderThickness="0"
                            Command="{Binding OpenParentTransactionView}"
                            CommandParameter="{Binding Account}">
                        <Button.ToolTip>
                            <ToolTip Content="{Binding}"
                                     ContentTemplate="{StaticResource ParentTransactionToolTipTemplate}"
                                     Visibility="{Binding SubTransactions, Converter={x:Static helper:Converters.NoneToCollapsed}}" />
                        </Button.ToolTip>
                        <iconPacks:PackIconMaterial Margin="5,0,0,0"
                                                    Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                                                    Kind="{StaticResource ParentIcon}"
                                                    Style="{StaticResource CellIconMaterial}" />
                    </Button>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Style="{StaticResource CellTextBlock}"
                                   Text="{Binding ToAccount.Name}" />
                        <iconPacks:PackIconMaterial Background="Transparent"
                                                    Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                                                    IsTabStop="True"
                                                    Kind="{StaticResource IncomeIcon}"
                                                    Style="{StaticResource CellIconMaterial}"
                                                    ToolTip="{Binding CurrentTexts.ToolTip_Symbol_ToAccount, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                    </StackPanel>
                </DataTemplate>
                <DataTemplate DataType="{x:Type structure:TransLikeViewModel}">
                    <ContentControl>
                        <ContentControl.Style>
                            <Style TargetType="ContentControl">
                                <Setter Property="Content" Value="{Binding Category}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=Content}"
                                                 Value="{x:Null}">
                                        <Setter Property="ContentControl.ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <TextBlock Foreground="{StaticResource TransferBrush}"
                                                               Opacity="0.75"
                                                               Style="{StaticResource CellTextBlock}">
                                                        <Run Text="(" />
                                                        <Run Text="{Binding CurrentTexts.General_Unassigned, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                                        <Run Text=")" />
                                                    </TextBlock>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ContentControl.Style>
                        <ContentControl.Resources>
                            <DataTemplate DataType="{x:Type forModels:CategoryViewModel}">
                                <TextBlock Style="{StaticResource CellTextBlock}"
                                           Text="{Binding Path=Name}">
                                    <TextBlock.ToolTip>
                                        <ToolTip>
                                            <ListBox ItemTemplate="{StaticResource CategoryItemTemplate}"
                                                     ItemsSource="{Binding FullChainOfCategories}">
                                                <ListBox.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ListBox.ItemsPanel>
                                            </ListBox>
                                        </ToolTip>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                            </DataTemplate>
                            <DataTemplate DataType="{x:Type forModels:IncomeCategoryViewModel}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Style="{StaticResource CellTextBlock}"
                                               Text="{Binding Name}">
                                        <TextBlock.ToolTip>
                                            <ToolTip>
                                                <ListBox ItemTemplate="{StaticResource CategoryItemTemplate}"
                                                         ItemsSource="{Binding FullChainOfCategories}">
                                                    <ListBox.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <StackPanel Orientation="Horizontal" />
                                                        </ItemsPanelTemplate>
                                                    </ListBox.ItemsPanel>
                                                </ListBox>
                                            </ToolTip>
                                        </TextBlock.ToolTip>
                                    </TextBlock>
                                    <iconPacks:PackIconMaterial Background="Transparent"
                                                                Foreground="{StaticResource IncomeBrush}"
                                                                Kind="{StaticResource IncomeIcon}"
                                                                Opacity="0.75"
                                                                Style="{StaticResource CellIconMaterial}"
                                                                ToolTip="{Binding CurrentTexts.ToolTip_Symbol_IncomeCategory, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}" />
                                </StackPanel>
                            </DataTemplate>
                        </ContentControl.Resources>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="CategoryEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type forModels:ParentTransactionViewModel}">
                    <Button Margin="0"
                            Padding="0"
                            HorizontalContentAlignment="Left"
                            Background="Transparent"
                            BorderThickness="0"
                            Command="{Binding OpenParentTransactionView}"
                            CommandParameter="{Binding Account}">
                        <Button.ToolTip>
                            <ToolTip Content="{Binding}"
                                     ContentTemplate="{StaticResource ParentTransactionToolTipTemplate}"
                                     Visibility="{Binding SubTransactions, Converter={x:Static helper:Converters.NoneToCollapsed}}" />
                        </Button.ToolTip>
                        <iconPacks:PackIconMaterial Margin="5,0,0,0"
                                                    Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                                                    Kind="{StaticResource ParentIcon}"
                                                    Style="{StaticResource CellIconMaterial}" />
                    </Button>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <ComboBox DisplayMemberPath="Name"
                              IsEditable="True"
                              IsTextSearchCaseSensitive="False"
                              IsTextSearchEnabled="True"
                              ItemsSource="{Binding AllAccounts}"
                              TextSearch.TextPath="Name">
                        <ComboBox.SelectedItem>
                            <Binding Mode="TwoWay"
                                     Path="ToAccount"
                                     UpdateSourceTrigger="LostFocus" />
                        </ComboBox.SelectedItem>
                    </ComboBox>
                </DataTemplate>
                <DataTemplate DataType="{x:Type structure:TransLikeViewModel}">
                    <DockPanel LastChildFill="True">
                        <Button Click="OpenCategoryPopup_OnClick"
                                DockPanel.Dock="Right"
                                TabIndex="1"
                                ToolTip="{Binding CurrentTexts.CreateNewCategory, Mode=OneWay, Source={StaticResource CurrentTextsViewModel}}">
                            <iconPacks:PackIconMaterial Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                                        Kind="{StaticResource AddIcon}"
                                                        Style="{StaticResource CellIconMaterial}" />
                        </Button>
                        <Popup x:Name="Popup"
                               Closed="Popup_OnClosed"
                               Placement="Right"
                               PlacementTarget="{Binding ElementName=EditCategoryComboBox}"
                               PopupAnimation="Slide"
                               PreviewKeyDown="Popup_OnPreviewKeyDown"
                               StaysOpen="False">
                            <Border MinWidth="50"
                                    Padding="0"
                                    BorderBrush="{StaticResource 	MahApps.Brushes.Accent}"
                                    BorderThickness="1">
                                <views:NewCategoryView DataContext="{Binding NewCategoryViewModel}"
                                                       OnAddClicked="ClosePopup_OnClick"
                                                       Tag="{Binding ElementName=Popup}" />
                            </Border>
                        </Popup>
                        <ComboBox x:Name="EditCategoryComboBox"
                                  IsEditable="True"
                                  IsTextSearchCaseSensitive="True"
                                  IsTextSearchEnabled="True"
                                  ItemTemplate="{StaticResource IndentedCategoryItemTemplate}"
                                  ItemsSource="{Binding NewCategoryViewModel.All}"
                                  ShouldPreserveUserEnteredPrefix="True"
                                  TabIndex="0"
                                  TextSearch.TextPath="Name">
                            <ComboBox.SelectedItem>
                                <Binding Mode="TwoWay"
                                         Path="Category"
                                         UpdateSourceTrigger="PropertyChanged">
                                    <Binding.ValidationRules>
                                        <x:Static Member="helper:Rules.EmptyCategory" />
                                    </Binding.ValidationRules>
                                </Binding>
                            </ComboBox.SelectedItem>
                            <ComboBox.ToolTip>
                                <ToolTip>
                                    <ListBox ItemTemplate="{StaticResource CategoryItemTemplate}"
                                             ItemsSource="{Binding Category.FullChainOfCategories}">
                                        <ListBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal" />
                                            </ItemsPanelTemplate>
                                        </ListBox.ItemsPanel>
                                    </ListBox>
                                </ToolTip>
                            </ComboBox.ToolTip>
                        </ComboBox>
                    </DockPanel>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="ParentCategoryEditingColumnTemplate"
                  DataType="{x:Type forModels:ParentTransactionViewModel}">
        <iconPacks:PackIconMaterial Margin="5,0,0,0"
                                    Foreground="{DynamicResource MahApps.Brushes.Gray4}"
                                    Kind="{StaticResource ParentIcon}"
                                    Style="{StaticResource CellIconMaterial}" />
    </DataTemplate>
    <!--  Memo  -->
    <DataTemplate x:Key="MemoColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransLikeViewModel}">
                    <TextBlock Style="{StaticResource CellTextBlock}"
                               Text="{Binding Memo, Mode=OneWay}"
                               TextTrimming="CharacterEllipsis"
                               ToolTip="{Binding Memo}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasMemo}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <TextBlock Margin="0,2.5"
                                                               Style="{StaticResource CellTextBlock}"
                                                               Text="{Binding Memo, Mode=OneWay}"
                                                               TextTrimming="CharacterEllipsis"
                                                               ToolTip="{Binding Memo}" />
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate" Value="{StaticResource EmptyDataTemplate}" />
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="MemoEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransLikeViewModel}">
                    <TextBox VerticalAlignment="Stretch"
                             VerticalContentAlignment="Center"
                             Focusable="True"
                             Text="{Binding Memo, UpdateSourceTrigger=LostFocus}"
                             TextWrapping="NoWrap" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasMemo}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <DockPanel LastChildFill="True">
                                                        <Button Margin="0,2.5"
                                                                Command="{Binding DismissMemo}"
                                                                Content="X"
                                                                DockPanel.Dock="Right" />
                                                        <TextBox Margin="0,2.5"
                                                                 VerticalAlignment="Stretch"
                                                                 VerticalContentAlignment="Center"
                                                                 DockPanel.Dock="Left"
                                                                 Focusable="True"
                                                                 Text="{Binding Memo, UpdateSourceTrigger=LostFocus}"
                                                                 TextWrapping="NoWrap" />
                                                    </DockPanel>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Button Margin="0,2.5"
                                                    HorizontalAlignment="Right"
                                                    Command="{Binding AdmitMemo}"
                                                    Content="+" />
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Sum  -->
    <DataTemplate x:Key="SumColumnTemplate">
        <ContentControl Content="{Binding}"
                        IsTabStop="True"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <TextBlock Padding="0,0,5,0"
                               Style="{StaticResource CellTextBlock}"
                               TextAlignment="Right">
                        <TextBlock.Text>
                            <MultiBinding Converter="{x:Static helper:Converters.TransferSumAsCorrectlySignedString}">
                                <Binding ElementName="LayoutRoot"
                                         Path="DataContext.AccountViewModel" />
                                <Binding Path="FromAccount" />
                                <Binding Path="ToAccount" />
                                <Binding Path="Sum.Value" />
                            </MultiBinding>
                        </TextBlock.Text>
                        <TextBlock.Foreground>
                            <MultiBinding Converter="{x:Static helper:Converters.TransferSumToSolidColorBrush}">
                                <Binding ElementName="LayoutRoot"
                                         Path="DataContext.AccountViewModel" />
                                <Binding Path="FromAccount" />
                                <Binding Path="ToAccount" />
                            </MultiBinding>
                        </TextBlock.Foreground>
                    </TextBlock>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:ParentTransactionViewModel}">
                    <Button Margin="0"
                            Padding="0"
                            HorizontalContentAlignment="Stretch"
                            Background="Transparent"
                            BorderThickness="0"
                            Command="{Binding OpenParentTransactionView}"
                            CommandParameter="{Binding Account}">
                        <Button.ToolTip>
                            <ToolTip Content="{Binding}"
                                     ContentTemplate="{StaticResource ParentTransactionToolTipTemplate}"
                                     Visibility="{Binding SubTransactions, Converter={x:Static helper:Converters.NoneToCollapsed}}" />
                        </Button.ToolTip>
                        <ContentControl>
                            <ContentControl.Style>
                                <Style TargetType="{x:Type ContentControl}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsInserted}"
                                                     Value="False">
                                            <Setter Property="Content" Value="{Binding TotalSum.Value}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                    <Setter Property="Content" Value="{Binding Sum.Value}" />
                                </Style>
                            </ContentControl.Style>
                            <ContentControl.ContentTemplate>
                                <DataTemplate>
                                    <TextBlock Padding="0,0,5,0"
                                               Foreground="{Binding ., Converter={x:Static helper:Converters.SumToSolidColorBrush}}"
                                               Style="{StaticResource CellTextBlock}"
                                               Text="{Binding ., Converter={x:Static helper:Converters.SumToString}}"
                                               TextAlignment="Right" />
                                </DataTemplate>
                            </ContentControl.ContentTemplate>
                        </ContentControl>
                    </Button>
                </DataTemplate>
                <DataTemplate DataType="{x:Type structure:TransLikeViewModel}">
                    <TextBlock Padding="0,0,5,0"
                               Foreground="{Binding Sum.Value, Converter={x:Static helper:Converters.SumToSolidColorBrush}}"
                               Style="{StaticResource CellTextBlock}"
                               Text="{Binding Sum.Value, Converter={x:Static helper:Converters.SumToString}}"
                               TextAlignment="Right" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasSum.Value}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <TextBlock Margin="0,2.5"
                                                               Foreground="{Binding Sum.Value, Converter={x:Static helper:Converters.SumToSolidColorBrush}}"
                                                               Style="{StaticResource CellTextBlock}"
                                                               Text="{Binding Sum.Value, Converter={x:Static helper:Converters.SumToString}}"
                                                               TextAlignment="Right" />
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate" Value="{StaticResource EmptyDataTemplate}" />
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="SumEditingColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type forModels:TransferViewModel}">
                    <TextBox VerticalContentAlignment="Center"
                             TextAlignment="Right">
                        <TextBox.Foreground>
                            <MultiBinding Converter="{x:Static helper:Converters.TransferSumToSolidColorBrush}">
                                <Binding ElementName="LayoutRoot"
                                         Path="DataContext.AccountViewModel" />
                                <Binding Path="FromAccount" />
                                <Binding Path="ToAccount" />
                            </MultiBinding>
                        </TextBox.Foreground>
                        <TextBox.Text>
                            <Binding Converter="{x:Static helper:Converters.SumToString}"
                                     Mode="TwoWay"
                                     Path="Sum.Value"
                                     UpdateSourceTrigger="LostFocus">
                                <Binding.ValidationRules>
                                    <x:Static Member="helper:Rules.Currency" />
                                    <x:Static Member="helper:Rules.CurrencyLongRange" />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:ParentTransactionViewModel}">
                    <Button Margin="0"
                            Padding="0"
                            HorizontalContentAlignment="Stretch"
                            Background="Transparent"
                            BorderThickness="0"
                            Command="{Binding OpenParentTransactionView}"
                            CommandParameter="{Binding Account}">
                        <Button.ToolTip>
                            <ToolTip Content="{Binding}"
                                     ContentTemplate="{StaticResource ParentTransactionToolTipTemplate}"
                                     Visibility="{Binding SubTransactions, Converter={x:Static helper:Converters.NoneToCollapsed}}" />
                        </Button.ToolTip>
                        <ContentControl>
                            <ContentControl.Style>
                                <Style TargetType="{x:Type ContentControl}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsInserted}"
                                                     Value="False">
                                            <Setter Property="Content" Value="{Binding TotalSum.Value}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                    <Setter Property="Content" Value="{Binding Sum.Value}" />
                                </Style>
                            </ContentControl.Style>
                            <ContentControl.ContentTemplate>
                                <DataTemplate>
                                    <TextBlock Padding="0,0,5,0"
                                               Foreground="{Binding ., Converter={x:Static helper:Converters.SumToSolidColorBrush}}"
                                               Style="{StaticResource CellTextBlock}"
                                               Text="{Binding ., Converter={x:Static helper:Converters.SumToString}}"
                                               TextAlignment="Right" />
                                </DataTemplate>
                            </ContentControl.ContentTemplate>
                        </ContentControl>
                    </Button>
                </DataTemplate>
                <DataTemplate DataType="{x:Type structure:TransLikeViewModel}">
                    <ContentControl Content="{Binding SumEdit}"
                                    ContentTemplate="{StaticResource SumEditTemplate}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type utility:CsvBankStatementImportItemViewModel}">
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="{x:Type ContentControl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasSum.Value}"
                                                 Value="True">
                                        <Setter Property="ContentTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <DockPanel LastChildFill="True">
                                                        <Button Margin="0,2.5"
                                                                Command="{Binding DismissSum}"
                                                                Content="X"
                                                                DockPanel.Dock="Right" />
                                                        <ContentControl Margin="0,2.5"
                                                                        Content="{Binding SumEdit}"
                                                                        ContentTemplate="{StaticResource SumEditTemplate}"
                                                                        DockPanel.Dock="Left" />
                                                    </DockPanel>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Button Margin="0,2.5"
                                                    HorizontalAlignment="Right"
                                                    Command="{Binding AdmitSum}"
                                                    Content="+" />
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <DataTemplate x:Key="ParentSumEditingColumnTemplate"
                  DataType="{x:Type forModels:ParentTransactionViewModel}">
        <ContentControl Content="{Binding SumEdit}"
                        ContentTemplate="{StaticResource SumEditTemplate}" />
    </DataTemplate>
    <!--  Cleared  -->
    <DataTemplate x:Key="ClearedColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <CheckBox MinHeight="30"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              IsChecked="{Binding Cleared, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                              Style="{StaticResource BffCheckBox}" />
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
    <!--  Context Menu  -->
    <DataTemplate x:Key="ContextMenuColumnTemplate">
        <ContentControl Content="{Binding}"
                        Style="{StaticResource CellContent}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type structure:TransBaseViewModel}">
                    <iconPacks:PackIconMaterial Width="{StaticResource IconSize}"
                                                Height="{StaticResource IconSize}"
                                                Margin="0"
                                                Padding="0"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="Transparent"
                                                Foreground="{DynamicResource 	MahApps.Brushes.Accent}"
                                                Kind="DotsHorizontal"
                                                Visibility="{Binding IsMouseOver, Converter={x:Static helper:Converters.FalseToCollapsed}, RelativeSource={RelativeSource AncestorType=DataGridRow}}">
                        <b:Interaction.Behaviors>
                            <attachedBehaviors:FrameworkElementClickBehavior Click="FrameworkElementClickBehavior_OnClick" />
                        </b:Interaction.Behaviors>
                    </iconPacks:PackIconMaterial>
                </DataTemplate>
                <DataTemplate DataType="{x:Type forModels:TransLikeViewModelPlaceholder}" />
            </ContentControl.Resources>
        </ContentControl>
    </DataTemplate>
</ResourceDictionary>